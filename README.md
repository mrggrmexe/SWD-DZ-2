# BankHSE

Проект по дисциплине **«Конструирование программного обеспечения»**  
Разработан на языке **C# (.NET 8)** в архитектуре **Domain–Application–Infrastructure** с консольным интерфейсом и модульными тестами.  

---

## 1. Общая концепция

Приложение моделирует модуль **«Учёт личных финансов»**, позволяющий:

- Управлять банковскими счетами, категориями и финансовыми операциями (доходы / расходы)
- Выполнять аналитику и формировать отчёты
- Импортировать и экспортировать данные в CSV-формате
- Работать через консольный интерфейс команд
- Измерять время выполнения сценариев

Проект демонстрирует применение паттернов проектирования, принципов **SOLID** и **GRASP**, а также аккуратную модульную структуру.

---

## 2. Структура решения

```
FinanceModule/
│
├── Domain/                     # Доменная модель
│   ├── Entity/                 # Сущности: BankAccount, Category, Operation
│   └── Factory/                # DomainFactory и IDomainFactory
│
├── Components/                 # Сервисный уровень и абстракции
│   ├── Abstraction/            # Интерфейсы: IRepo, IReportProc
│   ├── Command/                # Команды и Invoker (Command, Decorator)
│   ├── Export/                 # Экспорт (Visitor)
│   ├── Service/                # Facade-сервисы и Strategy-отчёты
│   └── Template/               # Импорт (Template Method)
│
├── Infrastructure/             # Репозитории и Proxy-слой
│   ├── Repository/             # StorageRepository, CachedRepositoryProxy
│
├── BankConsoleApp/             # Консольное приложение
│   ├── Program.cs              # Точка входа и Composition Root
│   └── Commands/               # Реализация всех CLI-команд
│
└── Tests/                      # Модульные тесты (xUnit)
    ├── DomainFactoryTests.cs
    ├── BankAccountTests.cs
    ├── CachedRepositoryProxyTests.cs
    ├── TimingCmdDecoratorTests.cs
    └── OperationCsvImporterTests.cs
```

---

## 3. Реализация ТЗ

В проекте реализованы все ключевые пункты задания:

| Раздел | Реализовано | Подробности |
|--------|--------------|-------------|
| **Доменная модель** | Да | Сущности: `BankAccount`, `Category`, `Operation`. Полностью отделены от логики и UI. |
| **Фабрика домена** | Да | Класс `DomainFactory` создаёт объекты с валидацией и восстановлением из данных. |
| **Репозиторий** | Да | `StorageRepository<T>` хранит сущности в памяти. Интерфейс `IRepo<T>`. |
| **Прокси (Proxy)** | Да | `CachedRepositoryProxy<T>` добавляет кэширование при доступе к данным. |
| **Импорт (Template Method)** | Да | `ImportTemplate<T>` с конкретными импортёрами `AccountCsvImporter` и `OperationCsvImporter`. |
| **Экспорт (Visitor)** | Да | `CsvExpProc` реализует экспорт всех сущностей в CSV-формате. |
| **Команды (Command)** | Да | Каждая операция пользователя — отдельная команда в `BankConsoleApp.Commands`. |
| **Декоратор (Decorator)** | Да | `TimingCmdDecorator` измеряет длительность исполнения каждой команды. |
| **Фасад (Facade)** | Да | Сервисы (`AccountService`, `OperationService`, `AnalysisService`) инкапсулируют бизнес-логику. |
| **Стратегия (Strategy)** | Да | `IReportProc` + `AmountDescProc`, `NameAscProc` — разные стратегии сортировки отчётов. |
| **Аналитика** | Да | `AnalysisService` — подсчёт доходов/расходов и группировка по категориям. |
| **Консольное взаимодействие** | Да | Пользователь взаимодействует через набор CLI-команд (`add`, `edit`, `list`, `report`, `export`, `import`, `exit`, `help`). |
| **Модульные тесты** | Да | Покрывают фабрику, доменные инварианты, прокси-кэш, декоратор и импорт. |

---

## 4. Паттерны проектирования

| Паттерн | Реализация | Назначение |
|----------|-------------|-------------|
| **Factory** | `DomainFactory` | Централизованное создание корректных доменных объектов |
| **Proxy** | `CachedRepositoryProxy` | Прозрачное кэширование обращений к данным |
| **Command** | Все классы из `BankConsoleApp.Commands` | Инкапсулируют операции пользователя |
| **Decorator** | `TimingCmdDecorator` | Добавляет измерение времени исполнения |
| **Template Method** | `ImportTemplate<T>` | Унифицирует процесс импорта из файлов |
| **Visitor / Strategy** | `CsvExpProc` | Унифицированный экспорт в разные форматы |
| **Strategy** | `IReportProc`, `AmountDescProc`, `NameAscProc` | Разные способы сортировки и аналитики |
| **Facade** | Сервисы | Предоставляют простой интерфейс к сложным взаимодействиям |

---

## 5. Принципы SOLID и GRASP

| Принцип | Где реализован | Описание |
|----------|----------------|----------|
| **SRP (Single Responsibility)** | Каждая команда, сервис, репозиторий | Один класс — одна ответственность |
| **OCP (Open/Closed)** | Через интерфейсы (`IRepo`, `ICommand`, `IReportProc`) | Добавление новых реализаций без изменения существующих |
| **LSP (Liskov Substitution)** | Репозитории и прокси | Любая реализация `IRepo<T>` может быть подставлена вместо другой |
| **ISP (Interface Segregation)** | Мелкие интерфейсы (`ICommand`, `IRepo`, `IReportProc`) | Зависимости только от нужных контрактов |
| **DIP (Dependency Inversion)** | Сервисы и консоль | Все зависимости внедряются через интерфейсы |

---

## 6. Примеры работы

### Пример добавления счёта
```
> add-account
Название счёта: Основной
Начальный баланс: 5000
Счёт создан: 3e2c... | Основной | Баланс: 5000
```

### Пример аналитики
```
> report-summary
Дата начала: 2025-01-01
Дата конца: 2025-12-31
Доходы: 120000
Расходы: 80000
Разница: 40000
```

---

## 7. Примеры CSV

### Пример импорта операций
```csv
Id;Type;AccountId;CategoryId;Amount;Date;Description
a1;Income;acc1;cat1;1000;2025-10-01;Salary
a2;Expense;acc1;cat2;150;2025-10-03;Coffee
```

### Пример экспорта категорий
```csv
Id;Name;FlowType
cat1;Зарплата;Income
cat2;Кафе;Expense
```

---

## 8. Запуск проекта

```bash
git clone https://github.com/mrggrmexe/SWD-DZ-2.git
cd SWD-DZ-2
dotnet restore
dotnet build
dotnet run
```

Для запуска тестов:

```bash
dotnet test
```

---

## 9. Используемые технологии

- **.NET 8.0 / C# 12**
- **xUnit** — модульное тестирование  
- **System.IO / LINQ / Collections** — работа с данными  
- **Console UI** — простой интерфейс взаимодействия  

---

## 10. Данные

**ФИО:** Штукмайстер Г.П.
**TG** @mrggrmexe

---

## 11. Заключение

Проект реализует все обязательные требования ТЗ:  
— архитектура из нескольких слоёв;  
— применение не менее 5 паттернов проектирования;  
— демонстрация принципов SOLID и GRASP;  
— наличие консольного интерфейса.  
